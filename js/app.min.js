"use strict";var webqGalleryPlaylistId="PLpEUxmlKGIdkkbHbf9aiuhj7_fJ7XIMMt",webqMapVidData=function(e){var t={},i=e.match(/[^\r\n]+/g);return t.phyName=i[0],t.phySpecialties=i[1],t.phyURL=i[2],t.phyPhoto=i[3],t.question=i[4],t},videoGalleryWidget=angular.module("videoGalleryWidget",["ngRoute","dibari.angular-ellipsis"]);videoGalleryWidget.config(["$sceDelegateProvider",function(e){e.resourceUrlWhitelist(["self","http://web-q-hospital.prod.ehc.com/**"])}]),videoGalleryWidget.config(["$routeProvider",function(e){e.when("/",{templateUrl:"partials/videos.html",controller:"galleryCtrl",controllerAs:"gallery",resolve:{youtubeData:["youtubeService",function(e){return e.getPlaylist()}]}}).when("/v/:videoId",{templateUrl:"partials/videos.html",controller:"galleryCtrl",controllerAs:"gallery",resolve:{youtubeData:["youtubeService",function(e){return e.getPlaylist()}]}}).otherwise({redirectTo:"/"})}]),videoGalleryWidget.constant("YT_event",{STOP:0,PLAY:1,PAUSE:2,STATUS_CHANGE:3}),videoGalleryWidget.service("youtubeService",["$http","$q",function(e,t){function i(i){var a="https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=6&playlistId="+webqGalleryPlaylistId+"&key=AIzaSyAIaRim_M52Tpr8fiGEItGTQ9Xw5rYUjjI";i&&(a=a+"&pageToken="+i);var o=t.defer();return e({method:"GET",url:a}).then(function(e){for(var t=e.data,i=0;i<t.items.length;i++)t.items[i].webq=webqMapVidData(t.items[i].snippet.description);o.resolve(t)},function(e){o.reject(e)}),o.promise}function a(i){var a="https://www.googleapis.com/youtube/v3/videos?part=snippet&maxResults=6&id="+i+"&key=AIzaSyAIaRim_M52Tpr8fiGEItGTQ9Xw5rYUjjI",o=t.defer();return e({method:"GET",url:a}).then(function(e){var t=e.data.items[0];t.webq=webqMapVidData(t.snippet.description),o.resolve(t)},function(e){o.reject(e)}),o.promise}return{getPlaylist:i,getVideo:a}}]),videoGalleryWidget.controller("galleryCtrl",["$routeParams","youtubeData","youtubeService",function(e,t,i){var a=this;e.videoId?(a.videoId=e.videoId,i.getVideo(a.videoId).then(function(e){a.current=e.webq})):(a.videoId=t.items[0].snippet.resourceId.videoId,a.current=t.items[0].webq),a.youtubeData=t,a.next=function(){i.getPlaylist(a.youtubeData.nextPageToken).then(function(e){a.youtubeData=e})},a.prev=function(){i.getPlaylist(a.youtubeData.prevPageToken).then(function(e){a.youtubeData=e})}}]),videoGalleryWidget.directive("youtube",["$window","YT_event",function(e,t){return{restrict:"E",scope:{height:"@",width:"@",videoid:"@"},template:"<div></div>",link:function(i,a,o,r){var n=document.createElement("script");n.src="https://www.youtube.com/iframe_api";var l=document.getElementsByTagName("script")[0];l.parentNode.insertBefore(n,l);var d;e.onYouTubeIframeAPIReady=function(){d=new YT.Player(a.children()[0],{playerVars:{controls:1,color:"white",autoplay:0,disablekb:1,enablejsapi:1,html5:1,iv_load_policy:3,modestbranding:0,showinfo:0},height:i.height,width:i.width,videoId:i.videoid,events:{onStateChange:function(e){var a={event:t.STATUS_CHANGE,data:""};switch(e.data){case YT.PlayerState.PLAYING:a.data="PLAYING";break;case YT.PlayerState.ENDED:a.data="ENDED";break;case YT.PlayerState.UNSTARTED:a.data="NOT PLAYING";break;case YT.PlayerState.PAUSED:a.data="PAUSED"}i.$apply(function(){i.$emit(a.event,a.data)})}}})},i.$watch("height + width",function(e,t){e!=t&&d.setSize(i.width,i.height)}),i.$watch("videoid",function(e,t){e!=t&&d.cueVideoById(i.videoid)}),i.$on(t.STOP,function(){d.seekTo(0),d.stopVideo()}),i.$on(t.PLAY,function(){d.playVideo()}),i.$on(t.PAUSE,function(){d.pauseVideo()})}}}]),angular.element(document).ready(function(){angular.bootstrap(document,["videoGalleryWidget"])});